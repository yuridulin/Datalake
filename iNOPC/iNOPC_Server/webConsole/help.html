<!DOCTYPE html>
<html lang="ru">

	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>iNOPC. Руководство по установке и настройке</title>
		<link rel="shortcut icon" href="./images/icon.ico" />
		<link rel="stylesheet" href="./css/help.css" />
	</head>

	<body>
		<h1>
			<a name="Содержание">iNOPC <span>1.5</span>
			<br />Руководство по установке и настройке</a>
		</h1>

		<h2><a>Содержание</a></h2>
		<ul>
			<li>
				<a href="#Установка">Установка</a>
			</li>
			<li>
				<a href="#Настройка">Настройка</a>
				<ul>
					<li><a href="#Учетные записи">Учетные записи</a></li>
					<li><a href="#Лицензирование">Лицензирование</a></li>
					<li><a href="#Управление службой">Управление службой</a></li>
					<li><a href="#Регистрация сервера">Регистрация сервера</a></li>
				</ul>
			</li>
			<li>
				<a href="#Работа с сервером">Работа с сервером</a>
				<ul>
					<li><a href="#Добавление драйвера">Добавление драйвера</a></li>
					<li><a href="#Окно управления драйвером">Окно управления драйвером</a></li>
					<li><a href="#Окно управления устройством">Окно управления устройством</a></li>
					<li><a href="#Вычисляемые значения">Вычисляемые значения</a></li>
				</ul>
			</li>
		</ul>

		<h2><a name="Установка" href="#Содержание">Установка</a></h2>
		<ol>
			<li>
				<p>Исходные файлы размещены в архиве <b>iNOPC.zip</b>. Их необходимо распаковать, путь распаковки не имеет
					значения.</p>
				<p><img src="images/image001.png" /></p>
			</li>
			<li>
				<p>После распаковки производим первый запуск сервера. Для этого запускаем исполняемый файл
					<b>iNOPC_Server.exe</b> в папке с распакованным архивом.</p>
				<p><i>Внимание</i>, для правильной настройки первый запуск нужно выполнить с правами администратора.</p>
				<p><img src="images/image003.png" /></p>
			</li>
			<li>
				<p>После запуска должно появиться консольное окно.</p>
				<p>Если его нет, проверьте наличие на сервере установленных пакетов:
				<ul>
					<li>
						<p><b>.NET Framework 4.5</b> - либо иная версия, совместимая с этой</p>
					</li>
					<li>
						<p><b>OPC Core Components 3.00</b> - либо более поздняя версия</p>
					</li>
				</ul>
				</p>
				<p>Исталляционные пакеты можно найти в папке <b>Redist</b></p>
				<p><img src="images/image005.png" /></p>
				<p>После доустановки необходимых компонентов снова пробуем запустить сервер</p>
			</li>
			<li>
				<p>При запуске сервера в оконном режиме запускается консольное окно сервера с ссылкой на веб-консоль.</p>
				<p>Конфигурирование и управление сервера проводится через неё</p>
				<p><img src="images/image007.png" /></p>
			</li>
			<li>
				<p>После того, как сервер запущен, дальнейшая работа ведется в веб-интерфейсе.</p>
				<p>Для того, чтобы туда попасть, набираем в браузере <a
						href="http://localhost:81"><b>http://localhost:81</b></a>. Если сервер в работе, а доступа к
					веб-консоли нет, убедитесь, что в вашей сети открыт TCP порт <b>81</b></p>
			</li>
			<li>
				<p>Первый запуск веб-консоли просит ввести пароль для первой учётной записи. Без создания учётной записи
					получить доступ к серверу не удастся. Первая учётная запись будет обладать полными правами доступа.</p>
				<p><img src="images/image009.png" /></p>
			</li>
			<li>
				<p>Установка завершена, сервер готов к работе.</p>
			</li>
		</ol>

		<h2><a name="Настройка" href="#Содержание">Настройка</a></h2>

		<h3><a name="Учетные записи" href="#Содержание">Учетные записи</a></h3>
		<ol>
			<p><img src="images/image011.png" /></p>
			<p>Для смены учётной записи необходимо нажать на Выход, а затем произвести вход с необходимыми учётными
				записями. Разные учётные записи могут иметь разные уровни доступа к просмотру данных и настройке сервера.
			</p>
			<p></p>
			<p><img src="images/image013.png" /></p>
			<p><img src="images/image015.png" /></p>
			<p>На этой странице можно произвести повторную инициализацию DCOM, выполнить обновление данных в тегах OPC
				сервера, а также управлять учётными записями.</p>
			<p>Для добавления новой учётной записи необходимо ввести логин, пароль и указать уровень доступа, а затем нажать
				<b>Добавить</b></p>
			<p><img src="images/image017.png" /></p>
			<p>Для удаления существующей учётной записи нажмите <b>Удалить</b></p>
			<p><img src="images/image019.png" /></p>
			<p>Доступны следующие права доступа:</p>
			<ul>
				<li>
					<p><b>доступ на чтение</b> – позволяет просматривать данные, получаемые с устройств</p>
					<p><img src="images/image021.png" /></p>
				</li>
				<li>
					<p><b>доступ на запись</b> – позволяет не только просматривать данные, но также и выполнять настройку
						драйверов и устройств</p>
					<p><img src="images/image023.png" /></p>
				</li>
				<li>
					<p><b>полный доступ</b> – дополнительно позволяет управлять учётными записями</p>
				</li>
			</ul>
			<p><i>Внимание</i>, если удалить все учетные записи с полным доступ, контроль над сервером будет утерян, и
				потребуется переустановка.</p>
		</ol>

		<h3><a name="Лицензирование" href="#Содержание">Лицензирование</a></h3>
		<ol>
			<p>iNOPC распространяется по модели <b>Shareware</b> с триал-периодом в <b>4</b> часа после запуска, в течении
				которых доступен весь функционал.</p>
			<p>По завершении триал-периода работа OPC сервера останавливается.</p>
			<p>Для отключения триал-периода нужно отправить распространителю идентификатор сервера, указанный на странице
				<b>Настройки</b> в веб-консоли, после чего тот присылает ключ лицензии.</p>
			<p><img src="images/image025.png" /></p>
			<p>После сохранения ключа сервер может работать в постоянном режиме.</p>
		</ol>

		<h3><a name="Управление службой" href="#Содержание">Управление службой</a></h3>
		<ol>
			<p>Работа с OPC сервером предполагает использование его как службы Windows. Оконный режим запуска даёт доступ к
				веб-консоли для настройки и регистрации службы, и не гарантирует доступ по OPC протоколу.</p>
			<p>Чтобы зарегистрировать службу, на странице <b>Настройки</b> в веб-консоли нужно нажать кнопку <b>Создать
					службу</b></p>
			<p><img src="images/image027.png" /></p>
			<p>После создания службы – закрыть окно сервера и запустить службу через оснастку Windows.</p>
			<p><img src="images/image028.png" /></p>
		</ol>

		<h3><a name="Регистрация сервера" href="#Содержание">Регистрация сервера</a></h3>
		<ol>
			<p>Для доступа к данным по протоколу OPC необходимо выполнить регистрацию в службе DCOM. Для этого есть кнопка
				на странице <b>Настройки</b> в веб-консоли. </p>
			<p><img src="images/image029.png" /></p>
			<p>Отмена регистрации нужна для ситуации, когда сервер обновлялся либо переносился в другое расположение.</p>
		</ol>

		<h2><a name="Работа с сервером" href="#Содержание">Работа с сервером</a></h2>

		<h3><a name="Добавление драйвера" href="#Содержание">Добавление драйвера</a></h3>
		<ol>
			<p><img src="images/image031.png" /></p>
			<p>Это окно не доступно при уровне доступа <b>Доступ на чтение</b></p>
			<p>В этом окне можно добавить новый драйвер для последующего добавления группы устройств этого типа. На тип
				устройств влияет указанная в драйвере DLL сборка.</p>
			<p>Структура OPC составляется следующим образом:</p>
			<p><img src="images/image033.png" /></p>
			<p><i>Внимание</i>, для корректной работы с OPC тегами имена драйверов, устройств и полей желательно указывать
				на латинице без спецсимволов и пробелов.</p>
			<p>После добавления драйвера будет выполнено перенаправление на окно управления драйвером.</p>
		</ol>

		<h3><a name="Окно управления драйвером" href="#Содержание">Окно управления драйвером</a></h3>
		<ol>
			<p><img src="images/image035.png" /></p>
			<p>В этом окне доступны операции переименования драйвера, обновления устройств в случае замены версии DLL сборки
				– <b>Перезагрузить</b>, и удаления драйвера.</p>
			<p>Также можно просматривать служебные сообщения драйвера в окне <b>Логи</b> и список использующих этот драйвер
				устройств в окне <b>Устройства</b>.</p>
			<p><img src="images/image037.png" /></p>
			<p>Для добавления нового устройства служит кнопка <b>Добавить устройство</b>. После нажатия будет создана
				страница устройства с случайным именем и настройками по умолчанию для этого типа устройств.</p>
			<p>При клике на имя устройства будет выполнено перенаправление на окно управления устройством.</p>
			<p>При клике на пиктограмму перед именем устройства получение данных с этого устройства будет запущено либо
				изменено.</p>
			<p><img src="images/image039.png" /></p>
		</ol>

		<h3><a name="Окно управления устройством" href="#Содержание">Окно управления устройством</a></h3>
		<ol>
			<p><img src="images/image041.png" /></p>
			<p>В этом окне можно просматривать переименовать устройство, задать для него автоматический запуск опроса после
				старта сервера, выполнить запуск либо остановку опроса, а также удалить данное устройство.</p>
			<p>Также доступны несколько вкладок: получаемые с устройства данные во вкладке Опрашиваемые параметры, служебные
				сообщения о работе устройства во вкладке Логи и настройки устройства во вкладке Настройки.</p>
			<p>Изменение имени устройства и настройки сохраняются после клика по кнопке Сохранить</p>
			<p><img src="images/image043.png" /></p>
			<p>Настройки устройства специфичны для каждого из драйверов. Справка по настройкам конкретных типов устройств
				будет добавлена в веб-клиент начиная со следующей версии.</p>
			<p>Поля с данными, получаемыми устройством, после запуска опроса становятся доступны в OPC дереве сервера.</p>
		</ol>

		<h3><a name="Вычисляемые значения" href="#Содержание">Вычисляемые значения</a></h3>
		<ol>
			<b></b>
			<p>Вычисляемые теги - теги, которые создаются вручную и имеют произвольную формулу, по которой с заданным промежутком вычисляется следующее значение.</p>
			<p><img src="images/image045.png" /></p>
			<p>На странице со списком вычисляемых тегов доступен просмотр текущих значений каждого тега, а так же просмотр информации о каждом теге в случае, если учетной записи представлен доступ на чтение, либо добавление нового либо изменение существующих - в случае доступа на запись либо администраторского.</p>
			<p>Так же в случае ошибок расчёта причина ошибки будет выведена в отдельное поле.</p>
			<p>Окно настройки вычисляемого тега</p>
			<p><img src="images/image047.png" /></p>
			<p>Доступно переименование, изменение интервала расчёта, возможность указать произвольное описание тега</p>
			<p>Формула пишется как математическое выражение на латинице без знака тождества. Доступны стандартные математические операторы, а так же список встроенных функций.</p>
			<p>
				<table>
					<thead>
						<tr>
							<th>Функция</th>
							<th>Описание</th>
							<th>Пример использв.</th>
							<th>Результат</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Abs</td>
							<td>Возвращает значение числа по модулю</td>
							<td>Abs(-1)</td>
							<td>1</td>
						</tr>
						<tr>
							<td>Acos</td>
							<td>Возвращает угол, косинус которого равен указанному числу.</td>
							<td>Acos(1)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Asin</td>
							<td>Возвращает угол, синус которого равен указанному числу.</td>
							<td>Asin(0)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Atan</td>
							<td>Возвращает угол, тангенс которого равен указанному числу.</td>
							<td>Atan(0)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Ceiling</td>
							<td>Возвращает наименьшее целое число, большее или равное указанному числу. </td>
							<td>Ceiling(1.5)</td>
							<td>2</td>
						</tr>
						<tr>
							<td>Cos</td>
							<td>Возвращает косинус указанного угла.</td>
							<td>Cos(0)</td>
							<td>1</td>
						</tr>
						<tr>
							<td>Exp</td>
							<td>Возвращает e, возведенное в указанную степень.</td>
							<td>Exp(0)</td>
							<td>1</td>
						</tr>
						<tr>
							<td>Floor</td>
							<td>Возвращает наибольшее целое число, меньшее или равное указанному числу.</td>
							<td>Floor(1.5)</td>
							<td>1</td>
						</tr>
						<tr>
							<td>IEEERemainder</td>
							<td>Возвращает остаток от деления указанного числа на другое указанное число.</td>
							<td>IEEERemainder(3, 2)</td>
							<td>-1</td>
						</tr>
						<tr>
							<td>Log</td>
							<td>Возвращает логарифм указанного числа. Второй параметр - основание логарифма.</td>
							<td>Log(1, 10)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Log10</td>
							<td>Возвращает логарифм указанного числа по основанию 10.</td>
							<td>Log10(1)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Max</td>
							<td>Возвращает большее из двух указанных чисел.</td>
							<td>Max(1, 2)</td>
							<td>2</td>
						</tr>
						<tr>
							<td>Min</td>
							<td>Возвращает меньшее из двух чисел.</td>
							<td>Min(1, 2)</td>
							<td>1</td>
						</tr>
						<tr>
							<td>Pow</td>
							<td>Возвращает указанное число, возведенное в указанную степень.</td>
							<td>Pow(3, 2)</td>
							<td>9</td>
						</tr>
						<tr>
							<td>Round</td>
							<td>Округляет значение до ближайшего целого числа или заданного количества знаков после запятой.</td>
							<td>Round(3.222, 2)</td>
							<td>3.22</td>
						</tr>
						<tr>
							<td>Sign</td>
							<td>Возвращает значение, указывающее знак числа.</td>
							<td>Sign(-10)</td>
							<td>-1</td>
						</tr>
						<tr>
							<td>Sin</td>
							<td>Возвращает синус указанного угла.</td>
							<td>Sin(0)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Sqrt</td>
							<td>Возвращает квадратный корень из указанного числа.</td>
							<td>Sqrt(4)</td>
							<td>2</td>
						</tr>
						<tr>
							<td>Tan</td>
							<td>Возвращает тангенс указанного угла.</td>
							<td>Tan(0)</td>
							<td>0</td>
						</tr>
						<tr>
							<td>Truncate</td>
							<td>Вычисляет целую часть числа.</td>
							<td>Truncate(1.7)</td>
							<td>1</td>
						</tr>
						<tr>
							<td>in</td>
							<td>Возвращает булевское значение, указывающее на то, находится ли элемент, переданный в функцию первым, в наборе значений среди остальных переданных в функцию значений.</td>
							<td>in(1 + 1, 1, 2, 3)</td>
							<td>true</td>
						</tr>
						<tr>
							<td>if</td>
							<td>Возвращает значение на основе условия. Первый аргумент - условие, второй - значение в случае истинности условия, третий - значение в случае ложности условия.</td>
							<td>if(3 % 2 = 1, 'правда', 'ложь')</td>
							<td>'правда'</td>
						</tr>
					</tbody>
				</table>
			</p>
			<p>
				Переменные - способ использовать значения других тегов сервера в формулах в удобном формате. В качестве переменных можно использовать и теги, данные для которых предоставляют другие устройства, и другие вычисляемые.
			</p>
			<p><img src="images/image049.png" /></p>
			<p>В случае синтаксической ошибки значение тега будет приравнено к нулю. Аналогично при ошибке вычисления. Если переменная имеет строковый тип, а используется как число, значение переменной будет приравнено к нулю. При этом доступны строковые операции, а так же строковый вывод в случае использования условных конструкций.</p>
			<p><img src="images/image051.png" /></p>
			<p>Для тегов, при вычислении или описании которых есть ошибки, качество в OPC сервере будет равно 0.</p>
			<p>По умолчанию вычисляемые теги не привязываются к какому-либо разделу в дереве OPC тегов и располагаются в корне.</p>
			<p><img src="images/image053.png" /></p>
			<p>Имена вычисляемых тегов можно давать произвольные, и в таком случае они будут располагаться в дереве OPC согласно нотации через разделители <b>.</b></p>
			<p><img src="images/image055.png" /></p>
			<p>Для стабильной работы рекомендуется в названиях вычисляемых тегов следовать правилам именования OPC тегов:
				<ul>
					<li><p>Символы - латиница и цифры</p></li>
					<li><p>Не использовать спецсимволы и пробелы</p></li>
				</ul>
			</p>
		</ol>


	

	</body>

</html>